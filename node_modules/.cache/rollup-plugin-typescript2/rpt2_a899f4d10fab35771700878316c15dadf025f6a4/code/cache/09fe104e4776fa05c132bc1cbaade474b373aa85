{"code":"import { PropsNames } from '../../BaseDefinitions';\r\nexport class BasePropertyManager {\r\n    constructor(state) {\r\n        this.state = state;\r\n    }\r\n    async getPropertySets(modelID, elementID, recursive = false) {\r\n        return await this.getProperty(modelID, elementID, recursive, PropsNames.psets);\r\n    }\r\n    async getTypeProperties(modelID, elementID, recursive = false) {\r\n        return await this.getProperty(modelID, elementID, recursive, PropsNames.type);\r\n    }\r\n    async getMaterialsProperties(modelID, elementID, recursive = false) {\r\n        return await this.getProperty(modelID, elementID, recursive, PropsNames.materials);\r\n    }\r\n    async getSpatialNode(modelID, node, treeChunks, includeProperties) {\r\n        await this.getChildren(modelID, node, treeChunks, PropsNames.aggregates, includeProperties);\r\n        await this.getChildren(modelID, node, treeChunks, PropsNames.spatial, includeProperties);\r\n    }\r\n    async getChildren(modelID, node, treeChunks, propNames, includeProperties) {\r\n        const children = treeChunks[node.expressID];\r\n        if (children == undefined)\r\n            return;\r\n        const prop = propNames.key;\r\n        const nodes = [];\r\n        for (let i = 0; i < children.length; i++) {\r\n            const child = children[i];\r\n            let node = this.newNode(modelID, child);\r\n            if (includeProperties) {\r\n                const properties = await this.getItemProperties(modelID, node.expressID);\r\n                node = { ...properties, ...node };\r\n            }\r\n            await this.getSpatialNode(modelID, node, treeChunks, includeProperties);\r\n            nodes.push(node);\r\n        }\r\n        node[prop] = nodes;\r\n    }\r\n    newNode(modelID, id) {\r\n        const typeName = this.getNodeType(modelID, id);\r\n        return {\r\n            expressID: id,\r\n            type: typeName,\r\n            children: []\r\n        };\r\n    }\r\n    async getSpatialTreeChunks(modelID) {\r\n        const treeChunks = {};\r\n        await this.getChunks(modelID, treeChunks, PropsNames.aggregates);\r\n        await this.getChunks(modelID, treeChunks, PropsNames.spatial);\r\n        return treeChunks;\r\n    }\r\n    saveChunk(chunks, propNames, rel) {\r\n        const relating = rel[propNames.relating].value;\r\n        const related = rel[propNames.related].map((r) => r.value);\r\n        if (chunks[relating] == undefined) {\r\n            chunks[relating] = related;\r\n        }\r\n        else {\r\n            chunks[relating] = chunks[relating].concat(related);\r\n        }\r\n    }\r\n    getRelated(rel, propNames, IDs) {\r\n        const element = rel[propNames.relating];\r\n        if (!element) {\r\n            return console.warn(`The object with ID ${rel.expressID} has a broken reference.`);\r\n        }\r\n        if (!Array.isArray(element))\r\n            IDs.push(element.value);\r\n        else\r\n            element.forEach((ele) => IDs.push(ele.value));\r\n    }\r\n    static isRelated(id, rel, propNames) {\r\n        const relatedItems = rel[propNames.related];\r\n        if (Array.isArray(relatedItems)) {\r\n            const values = relatedItems.map((item) => item.value);\r\n            return values.includes(id);\r\n        }\r\n        return relatedItems.value === id;\r\n    }\r\n    static newIfcProject(id) {\r\n        return {\r\n            expressID: id,\r\n            type: 'IFCPROJECT',\r\n            children: []\r\n        };\r\n    }\r\n    async getProperty(modelID, elementID, recursive = false, propName) {\r\n    }\r\n    async getChunks(modelID, chunks, propNames) {\r\n    }\r\n    async getItemProperties(modelID, expressID, recursive = false) {\r\n    }\r\n    getNodeType(modelID, id) {\r\n    }\r\n}\r\n//# sourceMappingURL=BasePropertyManager.js.map","references":["/Users/simquat/Development/web-ifc-three/web-ifc-three/src/IFC/BaseDefinitions.ts"],"map":"{\"version\":3,\"file\":\"BasePropertyManager.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/IFC/components/properties/BasePropertyManager.ts\"],\"names\":[],\"mappings\":\"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\"}"}
